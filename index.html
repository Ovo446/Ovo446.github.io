<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ClassicSpark V4</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: Georgia, serif;
      background-color: #f5fff4;
      margin: 0;
      padding: 0;
    }
    .header {
      background-color: #a8d5ba;
      color: #333;
      padding: 15px;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 1.4rem;
    }
    .logo {
      font-size: 2rem;
      margin-right: 10px;
    }
    .nav {
      text-align: center;
      margin: 20px;
    }
    .nav button {
      margin: 0 10px;
      padding: 10px 20px;
      border: 2px solid #ffd6a5;
      background-color: #a8d5ba;
      cursor: pointer;
      border-radius: 8px;
    }
    .nav button:hover {
      background-color: #c1e8c7;
    }
    .section {
      display: none;
      padding: 20px;
      text-align: center;
    }
    .active {
      display: block;
    }
    .word {
      color: #007700;
      text-decoration: underline dotted;
      cursor: pointer;
    }
    .card {
      background-color: #fff8f0;
      border: 1px solid #ffd6a5;
      border-radius: 8px;
      padding: 15px;
      margin-top: 15px;
      display: none;
    }
    .textarea {
      width: 90%;
      height: 60px;
      margin-top: 10px;
      font-family: Georgia, serif;
    }
    #wordbookList {
      margin-top: 20px;
    }
    .word-item {
      padding: 5px 10px;
      border-bottom: 1px solid #ccc;
    }
  </style>
</head>
<body>
  <div class="header">
    <span class="logo">üçä</span> ClassicSpark V4
  </div>

  <div class="nav">
    <button onclick="switchSection('home')">Home</button>
    <button onclick="switchSection('learn')">Daily Quote</button>
    <button onclick="switchSection('wordbook')">My Wordbook</button>
  </div>

  <div id="home" class="section active">
    <h2>Welcome to ClassicSpark</h2>
    <p>Study practical English phrases. Click on words to learn more.</p >
    <button onclick="switchSection('learn'); clickSound.play()">Start Learning</button>
  </div>

  <div id="learn" class="section">
    <h3>Today's Sentence</h3>
    <p id="quoteText">Loading...</p >
    <button onclick="speakQuote()">üîä Listen</button>
    <button onclick="mark()">üçä Mark Today</button>
    <p id="statusMsg"></p >

    <div id="card" class="card">
      <h4 id="cardWord"></h4>
      <p><b>IPA:</b> <span id="cardIPA"></span></p >
      <p><b>Definition:</b> <span id="cardEn"></span></p >
      <p><b>Chinese:</b> <span id="cardCn"></span></p >
      <p><b>Example:</b> <span id="cardEx"></span></p >
      <button onclick="addToWordbook()">Add to Wordbook</button>
      <div>
        <textarea id="note" class="textarea" placeholder="Write your note here..."></textarea>
      </div>
    </div>
  </div>

  <div id="wordbook" class="section">
    <h3>My Wordbook</h3>
    <div id="wordbookList"></div>
  </div>

  <audio id="clickSound" src="ui-soft-click.mp3" preload="auto"></audio>

  <script>
  const quotes = [
  "I need to charge my phone.",
  "Can you help me carry this?",
  "Let's take a break.",
  "I totally forgot!",
  "Don't worry about it.",
  "I'm just looking around.",
  "What do you recommend?",
  "I'll have the same, please.",
  "This place is amazing!",
  "Thanks for your help."
];

const dictionary = {
  charge: {
    ipa: "/t É…ëÀêrd í/",
    en: "to put electricity into a device",
    cn: "ÂÖÖÁîµ",
    ex: "I need to charge my phone before going out."
  },
  phone: {
    ipa: "/fo än/",
    en: "a mobile device used for communication",
    cn: "ÊâãÊú∫",
    ex: "Her phone rang during the meeting."
  },
  carry: {
    ipa: "/Ààk√¶ri/",
    en: "to hold and move something",
    cn: "Êê¨ËøêÔºåÊê∫Â∏¶",
    ex: "Can you help me carry this bag?"
  },
  break: {
    ipa: "/bre…™k/",
    en: "a short period of rest",
    cn: "‰ºëÊÅØ",
    ex: "Let's take a break and get coffee."
  },
  forgot: {
    ipa: "/f…ôrÀà…°…ëÀêt/",
    en: "failed to remember",
    cn: "ÂøòËÆ∞",
    ex: "I forgot my homework at home."
  },
  recommend: {
    ipa: "/Àårek…ôÀàmend/",
    en: "to suggest something as good",
    cn: "Êé®Ëçê",
    ex: "What do you recommend on the menu?"
  },
  amazing: {
    ipa: "/…ôÀàme…™z…™≈ã/",
    en: "very good or impressive",
    cn: "ÊÉä‰∫∫ÁöÑÔºåÊ£íÊûÅ‰∫Ü",
    ex: "This place is amazing!"
  }
};

let currentWord = "";

function switchSection(id) {
  clickSound.play();
  document.querySelectorAll(".section").forEach(el => el.classList.remove("active"));
  document.getElementById(id).classList.add("active");
  if (id === "wordbook") renderWordbook();
}

function speakQuote() {
  const text = document.getElementById("quoteText").innerText;
  const utter = new SpeechSynthesisUtterance(text);
  speechSynthesis.speak(utter);
}

function highlightWords(sentence) {
  const words = sentence.split(" ");
  return words.map(word => {
    const clean = word.toLowerCase().replace(/[^a-z]/gi, "");
    return dictionary[clean]
      ? `<span class="word" onclick="showCard('${clean}')">${word}</span>`
      : word;
  }).join(" ");
}

function loadQuote() {
  const sentence = quotes[Math.floor(Math.random() * quotes.length)];
  document.getElementById("quoteText").innerHTML = highlightWords(sentence);
}

function showCard(word) {
  currentWord = word;
  const data = dictionary[word];
  document.getElementById("cardWord").innerText = word;
  document.getElementById("cardIPA").innerText = data.ipa;
  document.getElementById("cardEn").innerText = data.en;
  document.getElementById("cardCn").innerText = data.cn;
  document.getElementById("cardEx").innerText = data.ex;
  document.getElementById("note").value = localStorage.getItem("note_" + word) || "";
  document.getElementById("card").style.display = "block";
  clickSound.play();
}

function addToWordbook() {
  const stored = JSON.parse(localStorage.getItem("wordbook") || "[]");
  if (!stored.includes(currentWord)) {
    stored.push(currentWord);
    localStorage.setItem("wordbook", JSON.stringify(stored));
  }
  localStorage.setItem("note_" + currentWord, document.getElementById("note").value);
  alert("Saved!");
}

function renderWordbook() {
  const list = document.getElementById("wordbookList");
  list.innerHTML = "";
  const stored = JSON.parse(localStorage.getItem("wordbook") || "[]");
  stored.forEach(word => {
    const data = dictionary[word] || {};
    const item = document.createElement("div");
    item.className = "word-item";
    item.innerHTML = `<b>${word}</b> (${data.ipa || ""}): ${data.en || ""}
    <br><em>CN:</em> ${data.cn || ""}<br><em>Note:</em> ${localStorage.getItem("note_" + word) || ""}`;
    list.appendChild(item);
  });
}

function mark() {
  const today = new Date().toDateString();
  localStorage.setItem("classicSparkV4_last", today);
  document.getElementById("statusMsg").textContent = "üçä Marked for today!";
}

const stored = localStorage.getItem("classicSparkV4_last");
if (stored === new Date().toDateString()) {
  document.getElementById("statusMsg").textContent = "üçä Already marked today!";
}

window.onload = loadQuote;
</script>
</body>
</html>
